[uwsgi]
master = true
vacuum = true
die-on-term = true
http-socket = :$(PORT)
disable-logging = true
log-4xx = true                       ; but log 4xx's anyway
log-5xx = true                       ; and 5xx's
log-format = UWSGI uwsgi "%(method) %(uri) %(proto)" %(status) %(size) %(msecs)ms [PID:%(pid):Worker-%(wid)] [RSS:%(rssM)MB]
buffer-size = 65535
post-buffering = 65535
post-buffering-bufsize = 65535
harakiri = 125
harakiri-verbose = true                ; forcefully kill workers after 60 seconds
py-callos-afterfork = true           ; allow workers to trap signals

listen = 512
max-requests = 256                  ; Restart workers after this many requests
max-worker-lifetime = 3600           ; Restart workers after this many seconds
reload-on-rss = 2000                 ; Restart workers after this much resident memory
worker-reload-mercy = 125             ; How long to wait before forcefully killing workers

processes = 8
enable-threads = true
threads = 4
stats-http = true
stats = :9191 --stats-http
memory-report = true
module = saleor.wsgi:application
static-map = /static=/app/static
mimefile = /etc/mime.types
ignore-sigpipe = true
ignore-write-errors = false
disable-write-exception = false
